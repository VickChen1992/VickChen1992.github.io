<!doctype html>



  


<html class="theme-next mist use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="CSharp,RSA,Java,PHP," />





  <link rel="alternate" href="/atom.xml" title="Vick's Blog" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/icon.ico?v=5.0.1" />






<meta name="description" content="在数据安全上rsa起着非常大的作用，特别是数据网络通讯的安全上。当异构系统在数据网络通讯上对安全性有所要求时，rsa将作为其中的一种选择，此时rsa的互通性就显得尤为重要了。
本文参考网络资料，提供了rsa互通性的一种可行的解决方案(c#,java,php),而这种互通性是在一定的局限性上达成的，比如密钥是1024位的(更高位没试过，应该也可行），基于PKCS1填充方式。
所编写的代码有一部分使用">
<meta property="og:type" content="article">
<meta property="og:title" content="rsa互通密钥对生成及互通加解密(c#,java,php)">
<meta property="og:url" content="VickChen.win/2017/RSA-key-pair-generate-and-interwork-encryp-decryp/index.html">
<meta property="og:site_name" content="Vick's Blog">
<meta property="og:description" content="在数据安全上rsa起着非常大的作用，特别是数据网络通讯的安全上。当异构系统在数据网络通讯上对安全性有所要求时，rsa将作为其中的一种选择，此时rsa的互通性就显得尤为重要了。
本文参考网络资料，提供了rsa互通性的一种可行的解决方案(c#,java,php),而这种互通性是在一定的局限性上达成的，比如密钥是1024位的(更高位没试过，应该也可行），基于PKCS1填充方式。
所编写的代码有一部分使用">
<meta property="og:updated_time" content="2018-11-22T03:24:13.201Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="rsa互通密钥对生成及互通加解密(c#,java,php)">
<meta name="twitter:description" content="在数据安全上rsa起着非常大的作用，特别是数据网络通讯的安全上。当异构系统在数据网络通讯上对安全性有所要求时，rsa将作为其中的一种选择，此时rsa的互通性就显得尤为重要了。
本文参考网络资料，提供了rsa互通性的一种可行的解决方案(c#,java,php),而这种互通性是在一定的局限性上达成的，比如密钥是1024位的(更高位没试过，应该也可行），基于PKCS1填充方式。
所编写的代码有一部分使用">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>




  <link rel="canonical" href="VickChen.win/2017/RSA-key-pair-generate-and-interwork-encryp-decryp/"/>

  <title> rsa互通密钥对生成及互通加解密(c#,java,php) | Vick's Blog </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Vick's Blog</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                rsa互通密钥对生成及互通加解密(c#,java,php)
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-06-02T00:41:31+08:00" content="2017-06-02">
              2017-06-02
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/技术/" itemprop="url" rel="index">
                    <span itemprop="name">技术</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>在数据安全上rsa起着非常大的作用，特别是数据网络通讯的安全上。当异构系统在数据网络通讯上对安全性有所要求时，rsa将作为其中的一种选择，此时rsa的互通性就显得尤为重要了。</p>
<p>本文参考网络资料，提供了rsa互通性的一种可行的解决方案(c#,java,php),而这种互通性是在一定的局限性上达成的，比如密钥是1024位的(更高位没试过，应该也可行），基于PKCS1填充方式。</p>
<p>所编写的代码有一部分使用了硬编码，同时注重了功能的实现，在类结构设计上关注不多，有需要的可自行修改重构。</p>
<a id="more"></a>
<p>相关的程序集或包或代码请详见本文末尾附件。</p>
<h3 id="生成互通密钥对"><a href="#生成互通密钥对" class="headerlink" title="生成互通密钥对"></a>生成互通密钥对</h3><p>重点参考了Jeffrey Walton（<a href="http://www.codeproject.com/Articles/25487/Cryptographic-Interoperability-Keys" target="_blank" rel="external">http://www.codeproject.com/Articles/25487/Cryptographic-Interoperability-Keys</a>）</p>
<p>1.C#</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">using</span> Cn.Ubingo.Security.RSA.Core;</div><div class="line"><span class="keyword">using</span> Cn.Ubingo.Security.RSA.Key;</div><div class="line"><span class="comment">//生成公私钥对</span></div><div class="line">KeyPair keyPair = KeyGenerator.GenerateKeyPair();</div><div class="line"><span class="comment">//转换成不同的格式</span></div><div class="line">KeyPair asnKeyPair = keyPair.ToASNKeyPair();</div><div class="line">KeyPair xmlKeyPair = asnKeyPair.ToXMLKeyPair();</div><div class="line">KeyPair pemKeyPair = xmlKeyPair.ToPEMKeyPair();</div><div class="line"></div><div class="line"><span class="comment">//获取公私钥，以xml格式的为例</span></div><div class="line"><span class="keyword">string</span> privateKey = xmlKeyPair.PrivateKey;</div><div class="line"><span class="keyword">string</span> publicKey = xmlKeyPair.PublicKey;</div></pre></td></tr></table></figure>
<p>2.Java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> cn.ubingo.security.rsa.core.*;</div><div class="line"><span class="keyword">import</span> cn.ubingo.security.rsa.key.*;</div><div class="line"><span class="comment">//生成密钥对</span></div><div class="line">KeyPair keyPair = KeyGenerator.generateKeyPair();</div><div class="line"><span class="comment">//转换成不同的格式</span></div><div class="line">KeyPair asnKeyPair = keyPair.toASNKeyPair();</div><div class="line">KeyPair xmlKeyPair = asnKeyPair.toXMLKeyPair();</div><div class="line">KeyPair pemKeyPair = xmlKeyPair.toPEMKeyPair();</div><div class="line"><span class="comment">//获取公私钥，以asn格式的为例</span></div><div class="line">String publicKey = asnKeyPair.getPublicKey();</div><div class="line">String privateKey = asnKeyPair.getPrivateKey();</div></pre></td></tr></table></figure>
<p>3.密钥格式</p>
<p>a.XML—c#平台惯用</p>
<p>私钥：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&lt;RSAKeyValue&gt;</div><div class="line">&lt;Modulus&gt;</div><div class="line">ociVSjfhJzxxAd9msplL4mllmaknjoB4OPgb+hVo1QGcQ9QWLyMHuPyCo3qbp3ahKqqa4nEkRkTHFOJeITXH69LE78Zyizne9N4hamAHZSVmuBa8dtsQmT06yJWxR4siG8JNMR9aQkMN7kGtxsJBN2+CbIomxSMWSQ2pqvFAyks=</div><div class="line">&lt;/Modulus&gt;</div><div class="line">&lt;Exponent&gt;AQAB&lt;/Exponent&gt;</div><div class="line">&lt;P&gt;0ekRMBZU0GhIYbTZSbnd/TC7QHtE4TCFfg98nOC8EBGBE6U5i3zgRofY0JdWBYmWNE5gtEMINPVfRxJ63Euwkw==&lt;/P&gt;</div><div class="line">&lt;Q&gt;xU5Vbntok5Emt8aP823gizSpG4h//5NvLBDAYpDmGSeg3Jxi1clJLu8d0bYfDOkk+QADYlpNdmJkH2lC4lXqaQ==&lt;/Q&gt;</div><div class="line">&lt;DP&gt;FvcKvFoVGV/vW1Ev3JMLKGImel2CIajvUeVb2sXzjUZ8+qs+6nXVC6JdJCUKcjylRD+28MHMqg6WR+5LpsJZJQ==&lt;/DP&gt;</div><div class="line">&lt;DQ&gt;Ah9ameqn8FZyZS20pLi83qJ9YzdvsQ8j9gRkHWtTnlenylfAVG5q5B9cYcIkyV3EsQ0H/EneZXSfgRr/xjGIaQ==&lt;/DQ&gt;</div><div class="line">&lt;InverseQ&gt;aCt01Nk4gANWR0JrYvJcsLgwB38OOG82hQrBa/quPkCMjGtLZzKh9TFiZjcTWLs1hsBvCPDBO7LM/wbZn1PG6A==&lt;/InverseQ&gt;</div><div class="line">&lt;D&gt;O+gF2+coMLqxT9O0+AJKtqp3bDhWRO6uVc4NsgN2f5VqkzU4B7lNdULPbxCKDa8gS6fD1YC2wWxbWZDe8SY0gjgOF1EUbbO8G1XvcHFE5rGxmZsFJCY+dhxgknqO08MXHVaZYjkmQO7z7XpvFKBocduj39NEe2mYO25l07TQfBk=&lt;/D&gt;</div><div class="line">&lt;/RSAKeyValue&gt;</div></pre></td></tr></table></figure>
<p>公钥：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;RSAKeyValue&gt;</div><div class="line">&lt;Modulus&gt;ociVSjfhJzxxAd9msplL4mllmaknjoB4OPgb+hVo1QGcQ9QWLyMHuPyCo3qbp3ahKqqa4nEkRkTHFOJeITXH69LE78Zyizne9N4hamAHZSVmuBa8dtsQmT06yJWxR4siG8JNMR9aQkMN7kGtxsJBN2+CbIomxSMWSQ2pqvFAyks=&lt;/Modulus&gt;</div><div class="line">&lt;Exponent&gt;AQAB&lt;/Exponent&gt;</div><div class="line">&lt;/RSAKeyValue&gt;</div></pre></td></tr></table></figure>
<p>b.ASN—java平台惯用</p>
<p>私钥：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">MIICdQIBADANBgkqhkiG9w0BAQEFAASCAl8wggJbAgEAAoGBAKHIlUo34Sc8cQHfZrKZS+JpZZmpJ46AeDj4G/oVaNUBnEPUFi8jB7j8gqN6m6d2oSqqmuJxJEZExxTiXiE1x+vSxO/Gcos53vTeIWpgB2UlZrgWvHbbEJk9OsiVsUeLIhvCTTEfWkJDDe5BrcbCQTdvgmyKJsUjFkkNqarxQMpLAgMBAAECgYA76AXb5ygwurFP07T4Akq2qndsOFZE7q5Vzg2yA3Z/lWqTNTgHuU11Qs9vEIoNryBLp8PVgLbBbFtZkN7xJjSCOA4XURRts7wbVe9wcUTmsbGZmwUkJj52HGCSeo7TwxcdVpliOSZA7vPtem8UoGhx26Pf00R7aZg7bmXTtNB8GQJBANHpETAWVNBoSGG02Um53f0wu0B7ROEwhX4PfJzgvBARgROlOYt84EaH2NCXVgWJljROYLRDCDT1X0cSetxLsJMCQQDFTlVue2iTkSa3xo/zbeCLNKkbiH//k28sEMBikOYZJ6DcnGLVyUku7x3Rth8M6ST5AANiWk12YmQfaULiVeppAkAW9wq8WhUZX+9bUS/ckwsoYiZ6XYIhqO9R5VvaxfONRnz6qz7qddULol0kJQpyPKVEP7bwwcyqDpZH7kumwlklAkACH1qZ6qfwVnJlLbSkuLzeon1jN2+xDyP2BGQda1OeV6fKV8BUbmrkH1xhwiTJXcSxDQf8Sd5ldJ+BGv/GMYhpAkBoK3TU2TiAA1ZHQmti8lywuDAHfw44bzaFCsFr+q4+QIyMa0tnMqH1MWJmNxNYuzWGwG8I8ME7ssz/BtmfU8bo</div></pre></td></tr></table></figure>
<p>公钥：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQChyJVKN+EnPHEB32aymUviaWWZqSeOgHg4+Bv6FWjVAZxD1BYvIwe4/IKjepundqEqqpricSRGRMcU4l4hNcfr0sTvxnKLOd703iFqYAdlJWa4Frx22xCZPTrIlbFHiyIbwk0xH1pCQw3uQa3GwkE3b4JsiibFIxZJDamq8UDKSwIDAQAB</div></pre></td></tr></table></figure>
<p>c.PEM—php平台惯用</p>
<p>私钥：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">-----BEGIN PRIVATE KEY-----</div><div class="line">MIICdQIBADANBgkqhkiG9w0BAQEFAASCAl8wggJbAgEAAoGBAKHIlUo34Sc8cQHf</div><div class="line">ZrKZS+JpZZmpJ46AeDj4G/oVaNUBnEPUFi8jB7j8gqN6m6d2oSqqmuJxJEZExxTi</div><div class="line">XiE1x+vSxO/Gcos53vTeIWpgB2UlZrgWvHbbEJk9OsiVsUeLIhvCTTEfWkJDDe5B</div><div class="line">rcbCQTdvgmyKJsUjFkkNqarxQMpLAgMBAAECgYA76AXb5ygwurFP07T4Akq2qnds</div><div class="line">OFZE7q5Vzg2yA3Z/lWqTNTgHuU11Qs9vEIoNryBLp8PVgLbBbFtZkN7xJjSCOA4X</div><div class="line">URRts7wbVe9wcUTmsbGZmwUkJj52HGCSeo7TwxcdVpliOSZA7vPtem8UoGhx26Pf</div><div class="line">00R7aZg7bmXTtNB8GQJBANHpETAWVNBoSGG02Um53f0wu0B7ROEwhX4PfJzgvBAR</div><div class="line">gROlOYt84EaH2NCXVgWJljROYLRDCDT1X0cSetxLsJMCQQDFTlVue2iTkSa3xo/z</div><div class="line">beCLNKkbiH//k28sEMBikOYZJ6DcnGLVyUku7x3Rth8M6ST5AANiWk12YmQfaULi</div><div class="line">VeppAkAW9wq8WhUZX+9bUS/ckwsoYiZ6XYIhqO9R5VvaxfONRnz6qz7qddULol0k</div><div class="line">JQpyPKVEP7bwwcyqDpZH7kumwlklAkACH1qZ6qfwVnJlLbSkuLzeon1jN2+xDyP2</div><div class="line">BGQda1OeV6fKV8BUbmrkH1xhwiTJXcSxDQf8Sd5ldJ+BGv/GMYhpAkBoK3TU2TiA</div><div class="line">A1ZHQmti8lywuDAHfw44bzaFCsFr+q4+QIyMa0tnMqH1MWJmNxNYuzWGwG8I8ME7</div><div class="line">ssz/BtmfU8bo</div><div class="line">-----END PRIVATE KEY-----</div></pre></td></tr></table></figure>
<p>公钥：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">-----BEGIN PUBLIC KEY-----</div><div class="line">MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQChyJVKN+EnPHEB32aymUviaWWZ</div><div class="line">qSeOgHg4+Bv6FWjVAZxD1BYvIwe4/IKjepundqEqqpricSRGRMcU4l4hNcfr0sTv</div><div class="line">xnKLOd703iFqYAdlJWa4Frx22xCZPTrIlbFHiyIbwk0xH1pCQw3uQa3GwkE3b4Js</div><div class="line">iibFIxZJDamq8UDKSwIDAQAB</div><div class="line">-----END PUBLIC KEY-----</div></pre></td></tr></table></figure>
<p>4.密钥互通性</p>
<p>各种格式的密钥都可以通过KeyPair类的c#:<code>To*KeyPair()</code>或java:<code>to*KeyPair()</code>方法相互进行转换，无门槛，无障碍。</p>
<p>C#</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//转换成不同的格式</span></div><div class="line">KeyPair asnKeyPair = keyPair.ToASNKeyPair();</div><div class="line">KeyPair xmlKeyPair = asnKeyPair.ToXMLKeyPair();</div><div class="line">KeyPair pemKeyPair = xmlKeyPair.ToPEMKeyPair();</div></pre></td></tr></table></figure>
<p>Java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//转换成不同的格式</span></div><div class="line">KeyPair asnKeyPair = keyPair.toASNKeyPair();</div><div class="line">KeyPair xmlKeyPair = asnKeyPair.toXMLKeyPair();</div><div class="line">KeyPair pemKeyPair = xmlKeyPair.toPEMKeyPair();</div></pre></td></tr></table></figure>
<h3 id="互通加解密"><a href="#互通加解密" class="headerlink" title="互通加解密"></a>互通加解密</h3><p>基于三种语言环境都支持的RSA PKCS1填充方式的算法，实现加解密互通</p>
<p>KeyWorker的c#:<code>Encrypt</code>,<code>Decrypt</code>或java:<code>encrypt</code>,<code>decrypt</code>或php:<code>encrypt</code>,<code>decrypt</code>方法实现加解密的功能</p>
<p>1.C# </p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">using</span> Cn.Ubingo.Security.RSA.Core;</div><div class="line"><span class="keyword">using</span> Cn.Ubingo.Security.RSA.Data;</div><div class="line"><span class="comment">//加解密</span></div><div class="line"></div><div class="line"><span class="comment">//XML</span></div><div class="line">KeyWorker privateWorker = <span class="keyword">new</span> KeyWorker(privateKey, KeyFormat.XML);</div><div class="line">KeyWorker publicWorker = <span class="keyword">new</span> KeyWorker(publicKey, KeyFormat.XML);            </div><div class="line">Console.WriteLine(privateWorker.Decrypt(publicWorker.Encrypt(<span class="string">"你好！世界"</span>)));</div><div class="line">Console.WriteLine(publicWorker.Decrypt(privateWorker.Encrypt(<span class="string">"你好！中国"</span>)));</div><div class="line"><span class="comment">//ASN</span></div><div class="line">privateWorker = <span class="keyword">new</span> KeyWorker(asnKeyPair.PrivateKey, KeyFormat.ASN);</div><div class="line">publicWorker = <span class="keyword">new</span> KeyWorker(asnKeyPair.PublicKey, KeyFormat.ASN);</div><div class="line">Console.WriteLine(privateWorker.Decrypt(publicWorker.Encrypt(<span class="string">"你好！世界"</span>)));</div><div class="line">Console.WriteLine(publicWorker.Decrypt(privateWorker.Encrypt(<span class="string">"你好！中国"</span>)));</div><div class="line"><span class="comment">//PEM</span></div><div class="line">privateWorker = <span class="keyword">new</span> KeyWorker(pemKeyPair.PrivateKey, KeyFormat.PEM);</div><div class="line">publicWorker = <span class="keyword">new</span> KeyWorker(pemKeyPair.PublicKey, KeyFormat.PEM);</div><div class="line">Console.WriteLine(privateWorker.Decrypt(publicWorker.Encrypt(<span class="string">"你好！世界"</span>)));</div><div class="line">Console.WriteLine(publicWorker.Decrypt(privateWorker.Encrypt(<span class="string">"你好！中国"</span>)));</div></pre></td></tr></table></figure>
<p>2.Java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> cn.ubingo.security.rsa.core.*;</div><div class="line"><span class="keyword">import</span> cn.ubingo.security.rsa.data.*;</div><div class="line"><span class="comment">//ASN</span></div><div class="line">KeyWorker privateWorker = <span class="keyword">new</span> KeyWorker(privateKey, KeyFormat.ASN);</div><div class="line">KeyWorker publicWorker = <span class="keyword">new</span> KeyWorker(publicKey, KeyFormat.ASN);</div><div class="line">System.out.print(privateWorker.decrypt(publicWorker.encrypt(<span class="string">"你好！世界"</span>)));</div><div class="line">System.out.print(publicWorker.decrypt(privateWorker.encrypt(<span class="string">"你好！中国"</span>)));</div><div class="line"><span class="comment">//XML</span></div><div class="line">privateWorker = <span class="keyword">new</span> KeyWorker(xmlKeyPair.getPrivateKey(), KeyFormat.XML);</div><div class="line">publicWorker = <span class="keyword">new</span> KeyWorker(xmlKeyPair.getPublicKey(), KeyFormat.XML);</div><div class="line">System.out.print(privateWorker.decrypt(publicWorker.encrypt(<span class="string">"你好！世界"</span>)));</div><div class="line">System.out.print(publicWorker.decrypt(privateWorker.encrypt(<span class="string">"你好！中国"</span>)));</div><div class="line"><span class="comment">//PEM</span></div><div class="line">privateWorker = <span class="keyword">new</span> KeyWorker(pemKeyPair.getPrivateKey(), KeyFormat.PEM);</div><div class="line">publicWorker = <span class="keyword">new</span> KeyWorker(pemKeyPair.getPublicKey(), KeyFormat.PEM);</div><div class="line">System.out.print(privateWorker.decrypt(publicWorker.encrypt(<span class="string">"你好！世界"</span>)));</div><div class="line">System.out.print(publicWorker.decrypt(privateWorker.encrypt(<span class="string">"你好！中国"</span>)));</div></pre></td></tr></table></figure>
<p>3.php<br>请保证php文件为utf-8的格式</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line">include "KeyWorker.php";</div><div class="line">use Cn\Ubingo\Security\RSA\Core as core;</div><div class="line">use Cn\Ubingo\Security\RSA\Data as data;</div><div class="line">/*PEM TEST*/</div><div class="line">$publicWorker = new data\KeyWorker("-----BEGIN PUBLIC KEY-----</div><div class="line">MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCZw5tyBNJsjgVrPkLUIWF9el5E</div><div class="line">OXL1AydVBnJ/WWPKTZJBWYxudW+1jI5ifML+1DkCxw/2QLowzViV1OLnpNAWr7zv</div><div class="line">LpN6i7OZtq0o2Yfc+vv6vCctTpMvFartRRwDeXTRBgoGd71UwWgdMOu8Gmr9sv5u</div><div class="line">3C9Kj5fhj0I4WgB94wIDAQAB</div><div class="line">-----END PUBLIC KEY-----",core\KeyFormat::PEM);</div><div class="line">$privateWorker = new data\KeyWorker("-----BEGIN PRIVATE KEY-----</div><div class="line">MIICdwIBADANBgkqhkiG9w0BAQEFAASCAmEwggJdAgEAAoGBAJnDm3IE0myOBWs+</div><div class="line">QtQhYX16XkQ5cvUDJ1UGcn9ZY8pNkkFZjG51b7WMjmJ8wv7UOQLHD/ZAujDNWJXU</div><div class="line">4uek0BavvO8uk3qLs5m2rSjZh9z6+/q8Jy1Oky8Vqu1FHAN5dNEGCgZ3vVTBaB0w</div><div class="line">67waav2y/m7cL0qPl+GPQjhaAH3jAgMBAAECgYA6ANHYlv0RuhlNNTVcdCMkhE6f</div><div class="line">CdTVnBTwO/hhFcVRASYUxMT2vhIfuB/WAx5DpqbC53ib+hrCYhPyoVXe8AsWjgBJ</div><div class="line">cj3RHxjLMou0Jbu6mTjcLgKzMYM85yHscmmDcc8l/ep9BhbiJJsTVM8RqqXfdPmY</div><div class="line">5CAgfwsNXruC7Zb5wQJBAMxVZhR+IzoeYLsmEciy2oOaTq5u8O6yjx7RapIggIKT</div><div class="line">dRU5G2GeCyLRHyZH/+U2/nL3undiP74fxizatzgTE3ECQQDApNKzaMobPW23wRes</div><div class="line">E+dDjJxYnqVqOmZS22D6s+BKwDmHpOt+oJmrirY4LWmOUwUfgAboDWH5y/q5+qJH</div><div class="line">P5STAkEAux+F4UR2nDXPnfPKG4L3K8f3QDUm/WGWQcHEF9gd9/Z0JaBrm+TxC8x4</div><div class="line">+0S6ar4HHWASalwWRdWxVchiO770cQJAGaEUAxhq4wreIPdIffU77Em1tziMC0Dv</div><div class="line">whA7q77olSlTvg8b4YHeT+spaPnptCypXtJ6mL7HDSOtHLcSheYYjwJBAJFdK3vg</div><div class="line">ZS0Sk4oy6iOaOcux+5uBkpF9ran0GIpehyGzia+F1Xf/+NnS22qER/ADvRMNnyHf</div><div class="line">QH24qWxQuST39UQ=</div><div class="line">-----END PRIVATE KEY-----",core\KeyFormat::PEM);</div><div class="line"></div><div class="line">echo $publicWorker-&gt;decrypt($privateWorker-&gt;encrypt("你好！世界"));</div><div class="line">echo $privateWorker-&gt;decrypt($publicWorker-&gt;encrypt("你好！中国"));</div><div class="line"></div><div class="line">/*ASN TEST*/</div><div class="line">$publicWorker = new data\KeyWorker("MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCZw5tyBNJsjgVrPkLUIWF9el5EOXL1AydVBnJ/WWPKTZJBWYxudW+1jI5ifML+1DkCxw/2QLowzViV1OLnpNAWr7zvLpN6i7OZtq0o2Yfc+vv6vCctTpMvFartRRwDeXTRBgoGd71UwWgdMOu8Gmr9sv5u3C9Kj5fhj0I4WgB94wIDAQAB",core\KeyFormat::ASN);</div><div class="line">$privateWorker = new data\KeyWorker("MIICdwIBADANBgkqhkiG9w0BAQEFAASCAmEwggJdAgEAAoGBAJnDm3IE0myOBWs+QtQhYX16XkQ5cvUDJ1UGcn9ZY8pNkkFZjG51b7WMjmJ8wv7UOQLHD/ZAujDNWJXU4uek0BavvO8uk3qLs5m2rSjZh9z6+/q8Jy1Oky8Vqu1FHAN5dNEGCgZ3vVTBaB0w67waav2y/m7cL0qPl+GPQjhaAH3jAgMBAAECgYA6ANHYlv0RuhlNNTVcdCMkhE6fCdTVnBTwO/hhFcVRASYUxMT2vhIfuB/WAx5DpqbC53ib+hrCYhPyoVXe8AsWjgBJcj3RHxjLMou0Jbu6mTjcLgKzMYM85yHscmmDcc8l/ep9BhbiJJsTVM8RqqXfdPmY5CAgfwsNXruC7Zb5wQJBAMxVZhR+IzoeYLsmEciy2oOaTq5u8O6yjx7RapIggIKTdRU5G2GeCyLRHyZH/+U2/nL3undiP74fxizatzgTE3ECQQDApNKzaMobPW23wResE+dDjJxYnqVqOmZS22D6s+BKwDmHpOt+oJmrirY4LWmOUwUfgAboDWH5y/q5+qJHP5STAkEAux+F4UR2nDXPnfPKG4L3K8f3QDUm/WGWQcHEF9gd9/Z0JaBrm+TxC8x4+0S6ar4HHWASalwWRdWxVchiO770cQJAGaEUAxhq4wreIPdIffU77Em1tziMC0DvwhA7q77olSlTvg8b4YHeT+spaPnptCypXtJ6mL7HDSOtHLcSheYYjwJBAJFdK3vgZS0Sk4oy6iOaOcux+5uBkpF9ran0GIpehyGzia+F1Xf/+NnS22qER/ADvRMNnyHfQH24qWxQuST39UQ=",core\KeyFormat::ASN);</div><div class="line"></div><div class="line">echo $publicWorker-&gt;decrypt($privateWorker-&gt;encrypt("你好！世界"));</div><div class="line">echo $privateWorker-&gt;decrypt($publicWorker-&gt;encrypt("你好！中国"));</div></pre></td></tr></table></figure>
<p>4.加解密互通性</p>
<p>任何语言（指的是c#,java,php)使用KeyWorker加密得到的密文，用任何语言的KeyWorker都可以进行解密，只要公私钥配对即可。</p>
<p><em>原文链接：<a href="http://www.cnblogs.com/FoChen/p/4740814.html" target="_blank" rel="external">http://www.cnblogs.com/FoChen/p/4740814.html</a></em></p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/CSharp/" rel="tag">#CSharp</a>
          
            <a href="/tags/RSA/" rel="tag">#RSA</a>
          
            <a href="/tags/Java/" rel="tag">#Java</a>
          
            <a href="/tags/PHP/" rel="tag">#PHP</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/how-to-use-partial-views/" rel="next" title="分部视图的使用">
                <i class="fa fa-chevron-left"></i> 分部视图的使用
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/unlimited-length-RAS-encryption-and-decryption/" rel="prev" title="不限长度RAS加密解密">
                不限长度RAS加密解密 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/uploads/avatar.jpg"
               alt="Vick" />
          <p class="site-author-name" itemprop="name">Vick</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">18</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">2</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">19</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/VickChen1992" target="_blank" title="github">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  github
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://twitter.com/_VickChen" target="_blank" title="twitter">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  twitter
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.facebook.com/VickChen92" target="_blank" title="facebook">
                  
                    <i class="fa fa-fw fa-facebook"></i>
                  
                  facebook
                </a>
              </span>
            
          
        </div>

        
        

        
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#生成互通密钥对"><span class="nav-number">1.</span> <span class="nav-text">生成互通密钥对</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#互通加解密"><span class="nav-number">2.</span> <span class="nav-text">互通加解密</span></a></li></ol></div>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Vick</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.0.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  



  




  
  

  

  

  

</body>
</html>
